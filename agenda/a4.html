<!-- ===================== PART 1/2 =====================
Cole este bloco primeiro no seu GitHub.
Na minha pr√≥xima resposta eu envio o PART 2/2 (o restante do <script>),
e voc√™ cola ele logo abaixo deste aqui.
====================================================== -->
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Agenda Pro ‚Ä¢ Planner (Apple/Microsoft-ish)</title>
  <meta name="theme-color" content="#0b0d12" />
  <meta name="color-scheme" content="dark light" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    :root{
      --bg0:#07080b; --bg1:#0b0d12;
      --cardA: rgba(255,255,255,.09);
      --cardB: rgba(255,255,255,.03);
      --text:#eaf0ff; --muted:#9aa6c3; --line:rgba(255,255,255,.10);
      --good:#2dd4bf; --bad:#fb7185; --warn:#fbbf24; --brand:#60a5fa;
      --shadow: 0 20px 90px rgba(0,0,0,.58);
      --shadow2: 0 12px 38px rgba(0,0,0,.40);
      --r:18px; --r2:26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Display","SF Pro Text","Segoe UI", Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --ring: 0 0 0 4px rgba(96,165,250,.14);
      --ring2: 0 0 0 5px rgba(45,212,191,.12);
      --tap:.985;
      --safeTop: env(safe-area-inset-top, 0px);
      --safeBottom: env(safe-area-inset-bottom, 0px);
      --glass: rgba(255,255,255,.06);
      --glass2: rgba(0,0,0,.18);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg0:#f7f7fb; --bg1:#eef0f6;
        --cardA: rgba(255,255,255,.82);
        --cardB: rgba(255,255,255,.62);
        --text:#0b0d12; --muted:rgba(60,60,67,.70); --line:rgba(60,60,67,.16);
        --shadow: 0 18px 60px rgba(0,0,0,.12);
        --shadow2: 0 10px 30px rgba(0,0,0,.10);
        --glass: rgba(255,255,255,.72);
        --glass2: rgba(255,255,255,.62);
      }
    }

    *{box-sizing:border-box; -webkit-tap-highlight-color:transparent;}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 15% -10%, rgba(96,165,250,.22), transparent 60%),
        radial-gradient(1000px 800px at 95% 10%, rgba(45,212,191,.14), transparent 55%),
        radial-gradient(900px 700px at 80% 115%, rgba(251,113,133,.12), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 55%, var(--bg0) 100%);
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .safe{padding: var(--safeTop) 0 var(--safeBottom) 0;}
    .wrap{max-width:1320px; margin:0 auto; padding:16px 16px 96px;}

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:50;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 14px;
      margin:-16px -16px 12px;
      backdrop-filter: blur(18px);
      background: linear-gradient(180deg, rgba(7,8,11,.92), rgba(7,8,11,.30));
      border-bottom:1px solid var(--line);
    }
    @media (prefers-color-scheme: light){
      .topbar{ background: linear-gradient(180deg, rgba(238,240,246,.90), rgba(238,240,246,.35)); }
    }
    .brand{display:flex; align-items:center; gap:12px; min-width:240px;}
    .logo{
      width:40px; height:40px; border-radius:14px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(20px 20px at 70% 30%, rgba(255,255,255,.15), transparent 60%),
        linear-gradient(135deg, rgba(96,165,250,.95), rgba(45,212,191,.75));
      border:1px solid rgba(255,255,255,.15);
      box-shadow: 0 16px 48px rgba(96,165,250,.18);
      flex:0 0 auto;
    }
    .brand h1{margin:0; font-size:14px; letter-spacing:.2px; line-height:1.1}
    .brand p{margin:0; font-size:12px; color:var(--muted); line-height:1.2}

    .pill{
      display:flex; align-items:center; gap:10px;
      border:1px solid var(--line); background:rgba(255,255,255,.04);
      border-radius:999px; padding:8px 10px;
      box-shadow: 0 6px 24px rgba(0,0,0,.25) inset;
      max-width:min(760px, 55vw);
      overflow:hidden;
    }
    .pill .dot{width:8px;height:8px;border-radius:999px;background:rgba(255,255,255,.22);box-shadow:0 0 0 3px rgba(255,255,255,.06)}
    .dot.good{background:rgba(45,212,191,.95); box-shadow:0 0 0 3px rgba(45,212,191,.12)}
    .dot.warn{background:rgba(251,191,36,.95); box-shadow:0 0 0 3px rgba(251,191,36,.12)}
    .dot.bad{background:rgba(251,113,133,.95); box-shadow:0 0 0 3px rgba(251,113,133,.12)}
    .pill span{font-size:12px; color:var(--muted); overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}

    .actions{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:center}
    .btn{
      appearance:none; border:none; cursor:pointer;
      border-radius:12px; padding:10px 12px;
      color:var(--text);
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      transition: transform .08s ease, background .15s ease, border-color .15s ease, filter .15s ease;
      font-size:13px;
      display:inline-flex; align-items:center; gap:9px;
      user-select:none;
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
      outline:none;
    }
    .btn:hover{background:rgba(255,255,255,.09); border-color:rgba(255,255,255,.14)}
    .btn:active{transform:scale(var(--tap))}
    .btn:focus-visible{box-shadow: var(--shadow), var(--ring)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(96,165,250,.95), rgba(45,212,191,.72));
      border-color: rgba(255,255,255,.18);
      color:#071017;
      font-weight:850;
    }
    .btn.danger{background:rgba(251,113,133,.14); border-color:rgba(251,113,133,.28)}
    .btn.ghost{background:transparent; box-shadow:none}

    .tabs{
      display:flex; gap:8px; flex-wrap:wrap;
      border:1px solid var(--line);
      background: rgba(0,0,0,.20);
      border-radius: 999px;
      padding:6px;
    }
    @media (prefers-color-scheme: light){ .tabs{background: rgba(255,255,255,.65);} }
    .tab{
      cursor:pointer;
      padding:9px 12px;
      border-radius: 999px;
      font-size:12px;
      border:1px solid transparent;
      color: rgba(233,240,255,.92);
      background: transparent;
      transition: background .15s ease, border-color .15s ease, transform .08s ease;
      user-select:none;
      display:flex; align-items:center; gap:8px;
      outline:none;
      white-space:nowrap;
    }
    @media (prefers-color-scheme: light){ .tab{color:rgba(11,13,18,.90);} }
    .tab:active{transform:scale(.99)}
    .tab:focus-visible{box-shadow: var(--ring2); border-color: rgba(45,212,191,.30)}
    .tab.active{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.14); }
    @media (prefers-color-scheme: light){ .tab.active{background: rgba(0,0,0,.06); border-color: rgba(0,0,0,.10);} }

    /* Layout */
    .grid{display:grid; grid-template-columns:1.2fr .8fr; gap:12px;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr;} }

    .card{
      background: linear-gradient(180deg, var(--cardA), var(--cardB));
      border:1px solid var(--line);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px 12px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), transparent);
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
      flex-wrap:wrap;
    }
    .title{display:flex; flex-direction:column; gap:4px;}
    .title h2{margin:0; font-size:14px; letter-spacing:.2px}
    .title p{margin:0; font-size:12px; color:var(--muted)}
    .card .bd{padding:14px 16px 16px;}

    .hint{font-size:12px; color:var(--muted); line-height:1.45}
    .kbd{
      font-family: var(--mono);
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: rgba(233,238,252,.92);
    }

    /* Fields */
    .filters{display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end;}
    .field{display:flex; flex-direction:column; gap:6px; min-width:160px;}
    .field label{font-size:11px; color:var(--muted)}
    input, select, textarea{
      width:100%;
      background: rgba(0,0,0,.22);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding:10px 10px;
      color: var(--text);
      outline:none;
      font-family: var(--sans);
      font-size: 13px;
    }
    @media (prefers-color-scheme: light){
      input,select,textarea{background: rgba(255,255,255,.70); color: #0b0d12;}
    }
    textarea{min-height:92px; resize: vertical;}
    input::placeholder, textarea::placeholder{color:rgba(154,166,195,.72)}
    input:focus, select:focus, textarea:focus{border-color: rgba(96,165,250,.55); box-shadow: var(--ring);}

    .divider{height:1px; background:var(--line); margin:12px 0;}

    /* Lists */
    .list{display:flex; flex-direction:column; gap:10px;}
    .row{
      display:grid;
      grid-template-columns: 1.2fr .7fr .6fr .9fr;
      gap:10px;
      align-items:center;
      padding:12px;
      border-radius: var(--r);
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
      cursor:pointer;
      outline:none;
    }
    @media (prefers-color-scheme: light){ .row{background: rgba(255,255,255,.60);} }
    .row:hover{border-color:rgba(255,255,255,.14); background: rgba(0,0,0,.22)}
    @media (prefers-color-scheme: light){ .row:hover{background: rgba(255,255,255,.76); border-color: rgba(0,0,0,.12);} }
    .row:active{transform:scale(.995)}
    .row:focus-visible{box-shadow: var(--ring2); border-color: rgba(45,212,191,.30)}
    @media (max-width:820px){ .row{grid-template-columns:1fr; gap:8px;} }

    .main{display:flex; flex-direction:column; gap:3px;}
    .name{font-size:13px; font-weight:900}
    .meta{font-size:11px; color:var(--muted); display:flex; flex-wrap:wrap; gap:8px}
    .badge{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .right{display:flex; justify-content:flex-end; gap:8px; flex-wrap:wrap}
    .mono{font-family:var(--mono)}
    .amount{ text-align:right; font-family: var(--mono); font-size: 12px; font-weight:900; white-space:nowrap; }

    /* KPI */
    .kpis{display:grid; grid-template-columns: repeat(4, 1fr); gap:10px;}
    @media (max-width:980px){ .kpis{grid-template-columns: repeat(2, 1fr);} }
    .kpi{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius: var(--r);
      padding:12px;
      display:flex; flex-direction:column; gap:6px;
      min-height:78px;
    }
    @media (prefers-color-scheme: light){ .kpi{background: rgba(255,255,255,.60);} }
    .kpi .label{font-size:12px; color:var(--muted)}
    .kpi .value{font-size:18px; font-weight:900; letter-spacing:.2px}
    .kpi .sub{font-size:11px; color:var(--muted)}
    .good{color:var(--good)} .bad{color:var(--bad)} .warn{color:var(--warn)}

    /* Kanban */
    .kanban{display:grid; grid-template-columns:repeat(3, 1fr); gap:10px;}
    @media (max-width:980px){ .kanban{grid-template-columns:1fr;} }
    .col{
      border:1px solid var(--line);
      border-radius:18px;
      background: rgba(0,0,0,.16);
      padding:10px;
      min-height:200px;
    }
    @media (prefers-color-scheme: light){ .col{background: rgba(255,255,255,.55);} }
    .colhead{display:flex; justify-content:space-between; align-items:center; gap:10px; margin-bottom:8px;}
    .coltitle{font-weight:950; font-size:12px; color:var(--muted); letter-spacing:.2px}
    .dropzone{display:flex; flex-direction:column; gap:8px; min-height:120px;}
    .task{
      border:1px solid var(--line);
      border-radius:16px;
      background: rgba(255,255,255,.06);
      padding:10px;
      cursor:grab;
      user-select:none;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }
    @media (prefers-color-scheme: light){ .task{background: rgba(255,255,255,.72);} }
    .task:active{cursor:grabbing; transform:scale(.997)}
    .task b{display:block; font-size:13px; margin-bottom:4px;}
    .task .tmeta{font-size:11px; color:var(--muted); display:flex; flex-wrap:wrap; gap:8px;}
    .drop-hover{outline: 2px dashed rgba(96,165,250,.55); outline-offset: 6px;}

    /* File chips */
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      border-radius:999px;
      padding:7px 10px;
      font-size:12px;
      font-weight:900;
      color: var(--text);
      cursor:pointer;
      user-select:none;
    }
    @media (prefers-color-scheme: light){ .chip{background: rgba(0,0,0,.05);} }
    .chip:active{transform:scale(var(--tap))}
    .chip small{font-weight:700; color:var(--muted)}
    .chip .x{
      width:18px;height:18px;border-radius:999px;
      display:grid; place-items:center;
      background: rgba(251,113,133,.14);
      border:1px solid rgba(251,113,133,.28);
      color: var(--bad);
      font-weight:1000;
      line-height:0;
    }

    /* Month planner (novo: cara de Calendar/Outlook) */
    .monthWrap{display:grid; grid-template-columns: 1fr; gap:10px;}
    .monthTop{
      display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;
      padding:10px;
      border-radius: var(--r);
      border:1px solid var(--line);
      background: rgba(0,0,0,.14);
    }
    @media (prefers-color-scheme: light){ .monthTop{background: rgba(255,255,255,.60);} }
    .monthTitle{font-weight:950; letter-spacing:.2px}
    .monthGrid{
      border:1px solid var(--line);
      border-radius: var(--r2);
      overflow:hidden;
      background: rgba(0,0,0,.12);
    }
    @media (prefers-color-scheme: light){ .monthGrid{background: rgba(255,255,255,.62);} }
    .monthHead{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
      gap:0;
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.04);
    }
    .monthHead div{
      padding:10px 10px;
      font-size:11px;
      color:var(--muted);
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:.12em;
    }
    .monthCells{
      display:grid;
      grid-template-columns: repeat(7, 1fr);
    }
    .dayCell{
      min-height:96px;
      border-right:1px solid var(--line);
      border-bottom:1px solid var(--line);
      padding:10px 10px 8px;
      position:relative;
      background: rgba(255,255,255,.02);
    }
    @media (prefers-color-scheme: light){ .dayCell{background: rgba(255,255,255,.35);} }
    .dayCell:nth-child(7n){border-right:none;}
    .dayNum{
      font-family: var(--mono);
      font-size:12px;
      font-weight:950;
      opacity:.95;
    }
    .dayNum.muted{color:var(--muted); opacity:.75}
    .dayCell.today{
      outline: 2px solid rgba(96,165,250,.42);
      outline-offset: -2px;
      box-shadow: 0 0 0 5px rgba(96,165,250,.10) inset;
    }
    .dots{display:flex; gap:6px; flex-wrap:wrap; margin-top:10px;}
    .dotItem{
      width:8px;height:8px;border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(96,165,250,.85);
    }
    .dotItem.task{background: rgba(45,212,191,.85);}
    .dotItem.note{background: rgba(251,191,36,.85);}
    .dayCell .miniCount{
      position:absolute; right:10px; top:10px;
      font-size:11px; color:var(--muted);
      border:1px solid var(--line);
      background: rgba(0,0,0,.12);
      padding:3px 8px; border-radius:999px;
    }
    @media (prefers-color-scheme: light){ .dayCell .miniCount{background: rgba(255,255,255,.65);} }

    /* Toast */
    .toast{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom: 16px;
      z-index:999;
      background: rgba(15,18,26,.88);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      padding:10px 14px;
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      max-width:min(980px, calc(100% - 22px));
      display:none;
      font-size:13px;
      color: var(--text);
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    @media (prefers-color-scheme: light){
      .toast{background: rgba(255,255,255,.86); border-color: rgba(0,0,0,.12);}
    }
    .toast.show{display:flex}
    .toast .msg{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:72vw}

    /* Modal */
    .modal{
      position:fixed; inset:0; display:none; place-items:center; z-index:1000;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
      padding: 16px;
    }
    .modal.show{display:grid}
    .panel{
      width:min(980px, 100%);
      border-radius: 24px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateY(4px);
    }
    @media (prefers-color-scheme: light){
      .panel{border-color: rgba(0,0,0,.12); background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.70));}
      .modal{background: rgba(0,0,0,.30);}
    }
    .phd{
      padding:14px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid var(--line);
    }
    .phd h3{margin:0; font-size:14px}
    .phd p{margin:0; font-size:12px; color:var(--muted)}
    .pbd{padding:14px 16px 16px;}
    .pft{
      padding:12px 16px;
      border-top:1px solid var(--line);
      display:flex; gap:10px; justify-content:space-between; align-items:center; flex-wrap:wrap;
    }

    /* Loading overlay */
    .loading{
      position:fixed; inset:0; z-index:1200;
      display:none; place-items:center;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
      padding: 16px;
    }
    .loading.show{display:grid}
    .loadingCard{
      width:min(560px, 100%);
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      padding: 14px 14px;
      display:flex;
      gap:12px;
      align-items:center;
    }
    @media (prefers-color-scheme: light){
      .loadingCard{border-color: rgba(0,0,0,.12); background: rgba(255,255,255,.85);}
      .loading{background: rgba(0,0,0,.18);}
    }
    .spinner{
      width:18px;height:18px;border-radius:999px;
      border:2px solid rgba(255,255,255,.18);
      border-top-color: rgba(96,165,250,.9);
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to{ transform: rotate(360deg);} }

    /* Mobile bottom nav */
    .bottomNav{
      position:fixed; left:0; right:0; bottom:0; z-index:60;
      padding: 10px 12px calc(10px + var(--safeBottom));
      backdrop-filter: blur(18px);
      background: linear-gradient(180deg, rgba(7,8,11,.10), rgba(7,8,11,.78));
      border-top: 1px solid var(--line);
      display:none;
    }
    @media (prefers-color-scheme: light){
      .bottomNav{ background: linear-gradient(180deg, rgba(238,240,246,.15), rgba(238,240,246,.86)); }
    }
    .bottomNav .tabs{width:100%; justify-content:space-between;}
    @media (max-width:980px){
      .bottomNav{display:block;}
      .desktopTabs{display:none;}
      .wrap{padding-bottom:132px;}
    }

    @media (prefers-reduced-motion: reduce){
      *{scroll-behavior:auto !important; transition:none !important; animation:none !important}
    }
  </style>
</head>

<body class="safe">
  <div class="wrap">
    <header class="topbar" role="banner">
      <div class="brand" aria-label="Identidade do app">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Agenda Pro</h1>
          <p id="subtitle">Planner ‚Ä¢ Agenda ‚Ä¢ Tarefas ‚Ä¢ Notas ‚Ä¢ Arquivos</p>
        </div>
      </div>

      <div class="actions" aria-label="A√ß√µes do topo">
        <div class="pill" title="Usu√°rio, hora, clima e localiza√ß√£o" aria-live="polite">
          <span class="dot" id="statusDot" aria-hidden="true"></span>
          <span id="statusLine">Inicializando‚Ä¶</span>
        </div>

        <div class="desktopTabs" aria-label="Navega√ß√£o">
          <div class="tabs" id="tabsTop" role="tablist">
            <button class="tab active" data-tab="today" role="tab">üìÖ Hoje</button>
            <button class="tab" data-tab="week" role="tab">üóìÔ∏è Semana</button>
            <button class="tab" data-tab="month" role="tab">üß≠ M√™s</button>
            <button class="tab" data-tab="tasks" role="tab">‚úÖ Tarefas</button>
            <button class="tab" data-tab="notes" role="tab">üìù Notas</button>
            <button class="tab" data-tab="files" role="tab">üìé Arquivos</button>
            <button class="tab" data-tab="settings" role="tab">‚öôÔ∏è Ajustes</button>
          </div>
        </div>

        <button class="btn ghost" id="btnBackup" title="Exportar backup JSON (Ctrl+E)">‚§ì Backup</button>
        <button class="btn primary" id="btnNew" title="Novo (N)">Ôºã Novo</button>
      </div>
    </header>

    <main class="grid" role="main">
      <!-- LEFT -->
      <section class="card" aria-label="Conte√∫do">
        <div class="hd">
          <div class="title">
            <h2 id="pageTitle">Hoje</h2>
            <p id="pageSub">Seus compromissos, atividades e quick actions</p>
          </div>

          <div class="right">
            <div class="field" style="min-width:220px;">
              <label for="quickFilter">Filtro r√°pido</label>
              <select id="quickFilter">
                <option value="all">Tudo</option>
                <option value="events">Compromissos</option>
                <option value="tasks">Tarefas</option>
                <option value="notes">Notas</option>
              </select>
            </div>
          </div>
        </div>

        <div class="bd">
          <!-- TODAY -->
          <div id="viewToday">
            <div class="kpis" aria-label="Indicadores do dia">
              <div class="kpi">
                <div class="label">Usu√°rio</div>
                <div class="value" id="kpiUser">‚Äî</div>
                <div class="sub">Perfil local</div>
              </div>
              <div class="kpi">
                <div class="label">Hoje</div>
                <div class="value" id="kpiDate">‚Äî</div>
                <div class="sub" id="kpiClock">‚Äî</div>
              </div>
              <div class="kpi">
                <div class="label">Compromissos</div>
                <div class="value" id="kpiEvents">‚Äî</div>
                <div class="sub">No dia</div>
              </div>
              <div class="kpi">
                <div class="label">Tarefas</div>
                <div class="value" id="kpiTasks">‚Äî</div>
                <div class="sub">A fazer / em andamento</div>
              </div>
            </div>

            <div class="divider"></div>

            <div class="filters" aria-label="Busca do dia">
              <div class="field" style="min-width:240px;">
                <label for="todaySearch">Buscar</label>
                <input id="todaySearch" placeholder="Ex: reuni√£o, m√©dico, obra, academia‚Ä¶" />
              </div>
              <div class="field" style="min-width:220px;">
                <label for="todayScope">Escopo</label>
                <select id="todayScope">
                  <option value="all">Tudo</option>
                  <option value="event">Compromissos</option>
                  <option value="task">Tarefas</option>
                  <option value="note">Notas</option>
                </select>
              </div>
              <div class="field" style="min-width:220px;">
                <label>&nbsp;</label>
                <button class="btn" id="btnQuickAdd">‚ú® Check-in r√°pido</button>
              </div>
            </div>

            <div class="divider"></div>

            <div class="title" style="margin-bottom:10px;">
              <h2 style="margin:0; font-size:13px;">Linha do dia</h2>
              <p style="margin:0; font-size:12px; color:var(--muted)">Compromissos + tarefas + notas (ordenado por hor√°rio)</p>
            </div>
            <div class="list" id="todayList"></div>
          </div>

          <!-- WEEK -->
          <div id="viewWeek" style="display:none;">
            <div class="filters">
              <div class="field" style="min-width:220px;">
                <label for="weekStart">Semana (in√≠cio)</label>
                <input id="weekStart" type="date" />
              </div>
              <div class="field" style="min-width:220px;">
                <label for="weekSearch">Buscar</label>
                <input id="weekSearch" placeholder="Ex: cliente, projeto, compromisso‚Ä¶" />
              </div>
              <div class="field" style="min-width:220px;">
                <label for="weekType">Tipo</label>
                <select id="weekType">
                  <option value="all">Tudo</option>
                  <option value="event">Compromissos</option>
                  <option value="task">Tarefas</option>
                  <option value="note">Notas</option>
                </select>
              </div>
            </div>

            <div class="divider"></div>

            <div class="hint">
              Dica: <span class="kbd">N</span> cria r√°pido ‚Ä¢ arraste tarefas no Kanban ‚Ä¢ anexos ficam no navegador (IndexedDB).
            </div>

            <div class="divider"></div>

            <div class="list" id="weekList"></div>
          </div>

          <!-- MONTH (novo) -->
          <div id="viewMonth" style="display:none;">
            <div class="monthWrap">
              <div class="monthTop">
                <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
                  <div class="monthTitle" id="monthTitle">‚Äî</div>
                  <span class="badge" id="monthMeta">‚Äî</span>
                </div>
                <div class="right">
                  <button class="btn" id="btnMonthPrev">‚Üê</button>
                  <button class="btn" id="btnMonthToday">Hoje</button>
                  <button class="btn" id="btnMonthNext">‚Üí</button>
                </div>
              </div>

              <div class="monthGrid" aria-label="Calend√°rio do m√™s">
                <div class="monthHead">
                  <div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>S√°b</div><div>Dom</div>
                </div>
                <div class="monthCells" id="monthCells"></div>
              </div>

              <div class="hint">
                Clique em um dia para abrir a agenda daquele dia. Os pontinhos mostram itens (üìÖ/‚úÖ/üìù).
              </div>
            </div>
          </div>

          <!-- TASKS -->
          <div id="viewTasks" style="display:none;">
            <div class="filters">
              <div class="field" style="min-width:260px;">
                <label for="taskSearch">Buscar</label>
                <input id="taskSearch" placeholder="Ex: enviar relat√≥rio, mercado, academia‚Ä¶" />
              </div>
              <div class="field" style="min-width:220px;">
                <label for="taskSort">Ordenar</label>
                <select id="taskSort">
                  <option value="priority">Prioridade</option>
                  <option value="due">Vencimento</option>
                  <option value="created">Cria√ß√£o</option>
                </select>
              </div>
              <div class="field" style="min-width:220px;">
                <label>&nbsp;</label>
                <button class="btn" id="btnNewTask">Ôºã Nova tarefa</button>
              </div>
            </div>

            <div class="divider"></div>

            <div class="kanban" id="kanban">
              <div class="col" data-col="todo">
                <div class="colhead">
                  <div class="coltitle">A FAZER</div>
                  <span class="badge" id="countTodo">0</span>
                </div>
                <div class="dropzone" id="zoneTodo"></div>
              </div>

              <div class="col" data-col="doing">
                <div class="colhead">
                  <div class="coltitle">EM ANDAMENTO</div>
                  <span class="badge" id="countDoing">0</span>
                </div>
                <div class="dropzone" id="zoneDoing"></div>
              </div>

              <div class="col" data-col="done">
                <div class="colhead">
                  <div class="coltitle">FEITO</div>
                  <span class="badge" id="countDone">0</span>
                </div>
                <div class="dropzone" id="zoneDone"></div>
              </div>
            </div>
          </div>

          <!-- NOTES -->
          <div id="viewNotes" style="display:none;">
            <div class="filters">
              <div class="field" style="min-width:260px;">
                <label for="noteSearch">Buscar</label>
                <input id="noteSearch" placeholder="Ex: ideias, reuni√µes, checklist‚Ä¶" />
              </div>
              <div class="field" style="min-width:220px;">
                <label for="noteTag">Tag</label>
                <input id="noteTag" placeholder="Ex: obra, pessoal‚Ä¶" />
              </div>
              <div class="field" style="min-width:220px;">
                <label>&nbsp;</label>
                <button class="btn" id="btnNewNote">Ôºã Nova nota</button>
              </div>
            </div>

            <div class="divider"></div>

            <div class="list" id="notesList"></div>
          </div>

          <!-- FILES -->
          <div id="viewFiles" style="display:none;">
            <div class="filters">
              <div class="field" style="min-width:280px;">
                <label for="fileSearch">Buscar arquivo</label>
                <input id="fileSearch" placeholder="Ex: pdf, contrato, foto‚Ä¶" />
              </div>
              <div class="field" style="min-width:240px;">
                <label>&nbsp;</label>
                <button class="btn" id="btnAddFiles">üìé Importar arquivos</button>
                <input id="filesInput" type="file" multiple style="display:none" />
              </div>
            </div>

            <div class="divider"></div>

            <div class="hint">
              Arquivos s√£o guardados <b>no seu navegador</b> (IndexedDB). Voc√™ pode anexar arquivos em compromissos/tarefas/notas.
            </div>

            <div class="divider"></div>

            <div class="list" id="filesList"></div>
          </div>

          <!-- SETTINGS -->
          <div id="viewSettings" style="display:none;">
            <div class="hint">
              Ajustes do app (salvo localmente). Para GPS e clima, √© melhor rodar em <b>HTTPS</b>.
            </div>

            <div class="divider"></div>

            <div class="filters">
              <div class="field" style="min-width:260px;">
                <label for="setUserName">Nome do usu√°rio</label>
                <input id="setUserName" placeholder="Ex: Wilson" />
              </div>
              <div class="field" style="min-width:260px;">
                <label for="setGeo">Localiza√ß√£o</label>
                <select id="setGeo">
                  <option value="ask">Perguntar / solicitar permiss√£o</option>
                  <option value="off">Desligado</option>
                </select>
              </div>
              <div class="field" style="min-width:260px;">
                <label for="setUnits">Unidades</label>
                <select id="setUnits">
                  <option value="metric">M√©trico (¬∞C, km)</option>
                  <option value="imperial">Imperial (¬∞F, mi)</option>
                </select>
              </div>
            </div>

            <div class="divider"></div>

            <div class="filters">
              <div class="field" style="min-width:260px;">
                <label>&nbsp;</label>
                <button class="btn primary" id="btnSaveSettings">‚úî Salvar ajustes</button>
              </div>
              <div class="field" style="min-width:260px;">
                <label>&nbsp;</label>
                <button class="btn" id="btnDemo">‚ú® Criar dados demo</button>
              </div>
              <div class="field" style="min-width:260px;">
                <label>&nbsp;</label>
                <button class="btn danger" id="btnWipe">üóëÔ∏è Limpar itens</button>
              </div>
            </div>

            <div class="divider"></div>

            <div class="hint">
              Atalhos: <span class="kbd">N</span> novo ‚Ä¢ <span class="kbd">Ctrl+E</span> backup ‚Ä¢ <span class="kbd">Esc</span> fechar modal ‚Ä¢ <span class="kbd">Ctrl+K</span> focar busca (Hoje).
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT: Quick Panel -->
      <aside class="card" aria-label="Painel r√°pido">
        <div class="hd">
          <div class="title">
            <h2>Centro</h2>
            <p id="rightSub">Resumo + a√ß√µes r√°pidas</p>
          </div>
          <button class="btn ghost" id="btnNow">‚ü≥ Atualizar</button>
        </div>

        <div class="bd">
          <div class="kpi" style="margin-bottom:10px;">
            <div class="label">Agora</div>
            <div class="value" id="nowTime">‚Äî</div>
            <div class="sub" id="nowMeta">‚Äî</div>
          </div>

          <div class="divider"></div>

          <div class="title" style="margin-bottom:10px;">
            <h2 style="margin:0; font-size:13px;">Pr√≥ximos 3</h2>
            <p style="margin:0; font-size:12px; color:var(--muted)">Compromissos e tarefas com vencimento</p>
          </div>
          <div class="list" id="nextList"></div>

          <div class="divider"></div>

          <div class="title">
            <h2 style="margin:0; font-size:13px;">Privacidade (r√°pido)</h2>
            <p style="margin:0; font-size:12px; color:var(--muted)">Localiza√ß√£o s√≥ se voc√™ permitir</p>
          </div>
          <div class="divider"></div>

          <div class="hint">
            ‚úÖ Sem login por enquanto<br/>
            ‚úÖ Salva no navegador (localStorage + IndexedDB)<br/>
            ‚úÖ Cada registro pode ter <b>hor√°rio</b>, <b>local</b>, <b>GPS</b> e <b>anexos</b><br/>
            ‚úÖ Novo: vis√£o <b>M√™s</b> estilo Calendar/Outlook
          </div>
        </div>
      </aside>
    </main>
  </div>

  <!-- Mobile bottom nav -->
  <nav class="bottomNav" aria-label="Navega√ß√£o inferior">
    <div class="tabs" id="tabsBottom" role="tablist">
      <button class="tab active" data-tab="today" title="Hoje">üìÖ</button>
      <button class="tab" data-tab="week" title="Semana">üóìÔ∏è</button>
      <button class="tab" data-tab="month" title="M√™s">üß≠</button>
      <button class="tab" data-tab="tasks" title="Tarefas">‚úÖ</button>
      <button class="tab" data-tab="notes" title="Notas">üìù</button>
      <button class="tab" data-tab="files" title="Arquivos">üìé</button>
      <button class="tab" data-tab="settings" title="Ajustes">‚öôÔ∏è</button>
    </div>
  </nav>

  <!-- Toast -->
  <div class="toast" id="toast" role="status" aria-live="polite" aria-hidden="true">
    <div class="msg" id="toastMsg">‚Äî</div>
    <button class="btn ghost" id="toastClose" style="padding:8px 10px;">OK</button>
  </div>

  <!-- Loading -->
  <div class="loading" id="loading" aria-hidden="true">
    <div class="loadingCard">
      <div class="spinner" aria-hidden="true"></div>
      <div>
        <div style="font-weight:950; font-size:13px;">Processando</div>
        <div class="hint" id="loadingMsg">Carregando‚Ä¶</div>
      </div>
    </div>
  </div>

  <!-- Create/Edit Modal -->
  <div class="modal" id="itemModal" aria-hidden="true">
    <div class="panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="phd">
        <div class="title">
          <h3 id="modalTitle">Novo</h3>
          <p id="modalSub">Compromisso, tarefa ou nota</p>
        </div>
        <div class="right">
          <button class="btn ghost" id="btnCloseModal">Fechar</button>
        </div>
      </div>

      <div class="pbd">
        <div class="filters">
          <div class="field" style="min-width:220px;">
            <label for="mType">Tipo</label>
            <select id="mType">
              <option value="event">Compromisso</option>
              <option value="task">Tarefa</option>
              <option value="note">Nota</option>
            </select>
          </div>

          <div class="field" style="min-width:280px; flex:1 1 auto;">
            <label for="mTitle">T√≠tulo</label>
            <input id="mTitle" placeholder="Ex: Reuni√£o com cliente / Academia / Ideia de projeto‚Ä¶" />
          </div>

          <div class="field" style="min-width:220px;">
            <label for="mPriority">Prioridade</label>
            <select id="mPriority">
              <option value="2">Normal</option>
              <option value="3">Alta</option>
              <option value="1">Baixa</option>
            </select>
          </div>
        </div>

        <div class="divider"></div>

        <div class="filters">
          <div class="field" style="min-width:240px;">
            <label for="mStart">In√≠cio</label>
            <input id="mStart" type="datetime-local" />
          </div>
          <div class="field" style="min-width:240px;">
            <label for="mEnd">Fim</label>
            <input id="mEnd" type="datetime-local" />
          </div>
          <div class="field" style="min-width:240px;">
            <label for="mDue">Vencimento (tarefa)</label>
            <input id="mDue" type="datetime-local" />
          </div>
        </div>

        <div class="divider"></div>

        <div class="filters">
          <div class="field" style="min-width:240px;">
            <label for="mLocationName">Local (texto)</label>
            <input id="mLocationName" placeholder="Ex: Escrit√≥rio, Casa, Rua X‚Ä¶" />
          </div>
          <div class="field" style="min-width:240px;">
            <label for="mTags">Tags (v√≠rgula)</label>
            <input id="mTags" placeholder="Ex: obra, pessoal, cliente" />
          </div>
          <div class="field" style="min-width:240px;">
            <label for="mStatus">Status</label>
            <select id="mStatus">
              <option value="planned">Planejado</option>
              <option value="doing">Em andamento</option>
              <option value="done">Conclu√≠do</option>
              <option value="canceled">Cancelado</option>
            </select>
          </div>
        </div>

        <div class="divider"></div>

        <div class="filters">
          <div class="field" style="min-width:280px; flex:1 1 auto;">
            <label for="mBody">Anota√ß√µes</label>
            <textarea id="mBody" placeholder="Detalhes, pauta, checklist, links‚Ä¶"></textarea>
          </div>
          <div class="field" style="min-width:320px;">
            <label for="mFiles">Anexos</label>
            <input id="mFiles" type="file" multiple />
            <div class="hint" style="margin-top:6px;">
              Dica: PDFs/fotos ficam no navegador. Voc√™ consegue baixar depois.
            </div>
            <div class="chips" id="mFileChips"></div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="filters">
          <div class="field" style="min-width:260px;">
            <label>Localiza√ß√£o (GPS)</label>
            <button class="btn" id="btnAttachGPS">üìç Anexar GPS agora</button>
            <div class="hint" id="gpsHint" style="margin-top:6px;">Sem GPS anexado.</div>
          </div>
          <div class="field" style="min-width:260px;">
            <label>Coluna Kanban</label>
            <select id="mKanban">
              <option value="todo">A fazer</option>
              <option value="doing">Em andamento</option>
              <option value="done">Feito</option>
            </select>
            <div class="hint" style="margin-top:6px;">S√≥ aplica para Tarefa.</div>
          </div>
        </div>
      </div>

      <div class="pft">
        <div class="hint" id="modalFootHint">Criado em: ‚Äî</div>
        <div class="right">
          <button class="btn danger" id="btnDelete" style="display:none;">üóëÔ∏è Excluir</button>
          <button class="btn" id="btnDuplicate">‚éò Duplicar</button>
          <button class="btn primary" id="btnSave">‚úî Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Restore Modal -->
  <div class="modal" id="restoreModal" aria-hidden="true">
    <div class="panel" role="dialog" aria-modal="true" aria-labelledby="restoreTitle">
      <div class="phd">
        <div class="title">
          <h3 id="restoreTitle">Importar backup</h3>
          <p>Restaura itens (sem anexos). Anexos ficam no seu navegador.</p>
        </div>
        <div class="right">
          <button class="btn ghost" id="btnCloseRestore">Fechar</button>
        </div>
      </div>
      <div class="pbd">
        <div class="filters">
          <div class="field" style="min-width:320px;">
            <label for="restoreFile">Arquivo JSON</label>
            <input id="restoreFile" type="file" accept="application/json" />
          </div>
          <div class="field" style="min-width:240px;">
            <label>&nbsp;</label>
            <button class="btn primary" id="btnDoRestore">‚¨Ü Importar</button>
          </div>
        </div>
        <div class="divider"></div>
        <div class="hint">
          Seguran√ßa: o backup √© s√≥ dados do app. Se o JSON n√£o for do seu app, n√£o importe.
        </div>
      </div>
    </div>
  </div>

<script>
/* =========================================================
   Agenda Pro ‚Äî single-file app (v2)
   - Mais "Calendar/Planner": inclui vis√£o M√äS
   - Data: localStorage + IndexedDB (files)
   - GPS: corre√ß√£o (usa state.tempGeo, sem gambiarra de dataset)
   ========================================================= */

const $ = (id)=>document.getElementById(id);
const $$ = (sel, root=document)=>Array.from(root.querySelectorAll(sel));

const LS_KEY = "agenda_pro_v2";
const LS_SETTINGS = "agenda_pro_settings_v2";
const DB_NAME = "AgendaProDB";
const DB_VER = 1;

const state = {
  activeTab: "today",
  items: [],
  settings: { userName: "Wilson", geo: "ask", units: "metric" },
  geo: { ok:false, lat:null, lon:null, accuracy:null, address:"", city:"", lastFixAt:0 },
  weather: { ok:false, temp:null, desc:"", code:null },
  toastsTimer: null,
  modalFocus: { active:false, lastFocus:null, handler:null },
  renderQueued: false,
  editingId: null,
  tempFiles: [],
  tempGeo: null,               // <<< NOVO (corrige GPS no save)
  monthCursor: new Date(),      // <<< NOVO (vis√£o m√™s)
  lastSearch: { today:"", week:"", notes:"", files:"", tasks:"" }
};

/* =========================================================
   UX helpers
   ========================================================= */
function showLoading(msg="Carregando‚Ä¶"){
  $("loadingMsg").textContent = msg;
  $("loading").classList.add("show");
  $("loading").setAttribute("aria-hidden","false");
}
function hideLoading(){
  $("loading").classList.remove("show");
  $("loading").setAttribute("aria-hidden","true");
}
function toast(msg){
  $("toastMsg").textContent = msg;
  $("toast").classList.add("show");
  $("toast").setAttribute("aria-hidden","false");
  clearTimeout(state.toastsTimer);
  state.toastsTimer = setTimeout(()=> {
    $("toast").classList.remove("show");
    $("toast").setAttribute("aria-hidden","true");
  }, 2600);
}
$("toastClose").addEventListener("click", ()=> {
  $("toast").classList.remove("show");
  $("toast").setAttribute("aria-hidden","true");
});
function rafRender(){
  if(state.renderQueued) return;
  state.renderQueued = true;
  requestAnimationFrame(async ()=>{
    state.renderQueued = false;
    await renderAll();
  });
}
function debounce(fn, ms){
  let t=null;
  return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), ms); };
}

/* =========================================================
   Modal accessibility
   ========================================================= */
function getFocusable(container){
  return Array.from(container.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'))
    .filter(el=>!el.disabled && el.offsetParent!==null);
}
function openModal(id){
  const m = $(id);
  state.modalFocus.lastFocus = document.activeElement;
  m.classList.add("show");
  m.setAttribute("aria-hidden","false");
  document.body.style.overflow = "hidden";

  const panel = m.querySelector(".panel");
  const f = getFocusable(panel);
  if(f[0]) f[0].focus({preventScroll:true});

  const handler = (e)=>{
    if(e.key !== "Tab") return;
    const items = getFocusable(panel);
    if(items.length===0) return;
    const first = items[0];
    const last = items[items.length-1];
    if(e.shiftKey && document.activeElement === first){
      e.preventDefault(); last.focus();
    }else if(!e.shiftKey && document.activeElement === last){
      e.preventDefault(); first.focus();
    }
  };
  state.modalFocus.active = true;
  state.modalFocus.handler = handler;
  document.addEventListener("keydown", handler);

  m.addEventListener("mousedown", modalBackdropClose);
}
function modalBackdropClose(e){
  const m = e.currentTarget;
  const panel = m.querySelector(".panel");
  if(!panel.contains(e.target)){
    if(m.id==="itemModal") closeModal("itemModal");
    if(m.id==="restoreModal") closeModal("restoreModal");
  }
}
function closeModal(id){
  const m = $(id);
  m.classList.remove("show");
  m.setAttribute("aria-hidden","true");
  document.body.style.overflow = "";
  m.removeEventListener("mousedown", modalBackdropClose);

  if(state.modalFocus.active){
    document.removeEventListener("keydown", state.modalFocus.handler);
    state.modalFocus.active = false;
    state.modalFocus.handler = null;
    if(state.modalFocus.lastFocus) state.modalFocus.lastFocus.focus({preventScroll:true});
  }
  if(id==="itemModal"){
    state.tempGeo = null; // <<< limpa temp geo ao fechar
  }
}

/* =========================================================
   Date helpers
   ========================================================= */
function pad(n){return String(n).padStart(2,"0");}
function toISODate(d){ return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`; }
function toLocalDTInputValue(d){ return `${toISODate(d)}T${pad(d.getHours())}:${pad(d.getMinutes())}`; }
function parseDT(v){
  if(!v) return null;
  const d = new Date(v);
  return isNaN(d.getTime()) ? null : d;
}
function fmtNiceDT(dt){
  if(!dt) return "‚Äî";
  const d = (dt instanceof Date) ? dt : new Date(dt);
  if(isNaN(d.getTime())) return "‚Äî";
  return d.toLocaleString("pt-BR", {weekday:"short", day:"2-digit", month:"2-digit", hour:"2-digit", minute:"2-digit"});
}
function fmtNiceDate(dt){
  const d = (dt instanceof Date) ? dt : new Date(dt);
  return d.toLocaleDateString("pt-BR", {weekday:"long", day:"2-digit", month:"long", year:"numeric"});
}
function startOfWeek(d){
  const x = new Date(d);
  const day = x.getDay();
  const diff = (day===0 ? -6 : 1-day);
  x.setDate(x.getDate()+diff);
  x.setHours(0,0,0,0);
  return x;
}
function addDays(d, n){ const x = new Date(d); x.setDate(x.getDate()+n); return x; }
function startOfMonth(d){ const x = new Date(d.getFullYear(), d.getMonth(), 1); x.setHours(0,0,0,0); return x; }
function endOfMonth(d){ const x = new Date(d.getFullYear(), d.getMonth()+1, 0); x.setHours(23,59,59,999); return x; }

function withinDay(item, day){
  const s = item.start ? new Date(item.start) : null;
  const e = item.end ? new Date(item.end) : null;
  const due = item.due ? new Date(item.due) : null;

  const day0 = new Date(day); day0.setHours(0,0,0,0);
  const day1 = new Date(day0); day1.setDate(day0.getDate()+1);

  if(item.type==="event"){
    const a = s || due || new Date(item.createdAt);
    const b = e || s || a;
    return (a < day1 && b >= day0);
  }
  if(item.type==="task"){
    const a = due || s || new Date(item.createdAt);
    return (a >= day0 && a < day1);
  }
  const a = new Date(item.createdAt);
  return (a >= day0 && a < day1);
}
function rangeFilter(items, from, to){
  const a = new Date(from); a.setHours(0,0,0,0);
  const b = new Date(to); b.setHours(23,59,59,999);
  return items.filter(it=>{
    const key = it.start || it.due || it.createdAt;
    const d = new Date(key);
    return d>=a && d<=b;
  });
}
</script>

<!-- ===================== FIM PART 1/2 =====================
Na pr√≥xima resposta eu envio o PART 2/2 com todo o restante do JS:
- Storage + IndexedDB
- Geo/Weather
- CRUD
- Render (Hoje/Semana/M√™s/Tarefas/Notas/Arquivos)
- Bindings/atalhos
- Init
========================================================== -->
<!-- =========================================================
     PARTE 2 (cole IMEDIATAMENTE abaixo do fim da PARTE 1,
     antes de fechar </script></body></html> se no seu arquivo
     a PARTE 1 j√° estiver fechando. Se a PARTE 1 j√° terminou
     com </html>, apague APENAS o bloco final </script></body></html>
     e cole esta PARTE 2 em seguida (ela completa o <script> e o HTML).
========================================================== -->

<!-- (A) SEMANA/M√äS: vamos inserir a nova aba "M√™s" e a view via JS (n√£o precisa mexer no HTML acima) -->
<script>
/* =========================================================
   Agenda Pro ‚Äî PARTE 2
   Adds: Month view (grid), day drawer, quick create,
         persist active tab + month cursor, drag/drop to day
   ========================================================= */

(function(){
  const LS_ACTIVE_TAB = "agenda_pro_active_tab_v1";
  const LS_MONTH_CURSOR = "agenda_pro_month_cursor_v1";
  const TAB_ORDER = ["today","week","month","tasks","notes","files","settings"];

  // ---------- tiny safe helpers ----------
  const $ = (id)=>document.getElementById(id);
  const $$ = (sel, root=document)=>Array.from(root.querySelectorAll(sel));
  const pad = (n)=>String(n).padStart(2,"0");
  const toISODate = (d)=>`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
  const escapeHtml = (s)=>String(s||"")
    .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
    .replaceAll('"',"&quot;").replaceAll("'","&#039;");

  function addDays(d, n){ const x=new Date(d); x.setDate(x.getDate()+n); return x; }
  function startOfDay(d){ const x=new Date(d); x.setHours(0,0,0,0); return x; }
  function startOfWeekMon(d){
    const x = startOfDay(d);
    const day = x.getDay(); // 0 dom
    const diff = (day===0 ? -6 : 1-day);
    x.setDate(x.getDate()+diff);
    return x;
  }
  function fmtWeekdayShort(i){ return ["SEG","TER","QUA","QUI","SEX","S√ÅB","DOM"][i]; }
  function monthKey(d){ return `${d.getFullYear()}-${pad(d.getMonth()+1)}`; }
  function parseMonthKey(k){
    const [y,m]=String(k||"").split("-").map(Number);
    if(!y || !m) return null;
    return new Date(y, m-1, 1);
  }
  function clampText(s, n){ return String(s||"").slice(0,n); }

  // ---------- access to your existing app state ----------
  // We reuse window.state, window.setTab, window.rafRender, etc. (from Parte 1)
  const S = window.state;
  if(!S){
    console.warn("PARTE 2: state n√£o encontrado. Cole esta parte abaixo do script da PARTE 1.");
    return;
  }

  // ---------- inject minimal CSS for month UI ----------
  (function injectCSS(){
    const css = `
      .monthWrap{display:flex; flex-direction:column; gap:12px;}
      .monthTop{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
      .monthTitle{display:flex; flex-direction:column; gap:2px}
      .monthTitle b{font-size:14px}
      .monthTitle span{font-size:12px; color:var(--muted)}
      .monthBtns{display:flex; gap:8px; flex-wrap:wrap}
      .monthGrid{
        border:1px solid var(--line);
        border-radius: 18px;
        overflow:hidden;
        background: rgba(0,0,0,.16);
      }
      @media (prefers-color-scheme: light){ .monthGrid{background: rgba(255,255,255,.55);} }
      .monthHead{
        display:grid;
        grid-template-columns: repeat(7, 1fr);
        gap:0;
        border-bottom:1px solid var(--line);
        background: linear-gradient(180deg, rgba(255,255,255,.06), transparent);
      }
      .mhCell{padding:10px 10px; font-size:11px; letter-spacing:.6px; color:var(--muted); font-weight:950}
      .monthBody{
        display:grid;
        grid-template-columns: repeat(7, 1fr);
      }
      .dayCell{
        min-height: 92px;
        padding:10px;
        border-right:1px solid var(--line);
        border-bottom:1px solid var(--line);
        cursor:pointer;
        background: rgba(255,255,255,.02);
        transition: background .12s ease, transform .08s ease;
        outline:none;
        position:relative;
      }
      .dayCell:hover{background: rgba(255,255,255,.05)}
      .dayCell:active{transform: scale(.997)}
      .dayCell:nth-child(7n){border-right:none;}
      .dayNum{
        font-size:12px; font-weight:950;
        display:flex; align-items:center; justify-content:space-between; gap:8px;
      }
      .dayNum small{color:var(--muted); font-weight:800}
      .dayBadges{display:flex; gap:6px; flex-wrap:wrap; margin-top:8px}
      .dotBadge{
        display:inline-flex; align-items:center; gap:6px;
        font-size:11px; font-weight:900;
        border:1px solid var(--line);
        border-radius:999px;
        padding:4px 8px;
        background: rgba(255,255,255,.05);
      }
      .dayCell.out{opacity:.48}
      .dayCell.today{box-shadow: inset 0 0 0 2px rgba(45,212,191,.24);}
      .dayCell.drop{outline: 2px dashed rgba(96,165,250,.55); outline-offset:-6px;}
      .drawer{
        border:1px solid var(--line);
        border-radius: 18px;
        background: rgba(0,0,0,.16);
        padding:12px;
      }
      @media (prefers-color-scheme: light){ .drawer{background: rgba(255,255,255,.55);} }
      .drawerTop{display:flex; align-items:flex-start; justify-content:space-between; gap:10px; flex-wrap:wrap}
      .drawerTop b{font-size:13px}
      .drawerTop span{font-size:12px; color:var(--muted)}
      .drawerList{display:flex; flex-direction:column; gap:10px; margin-top:10px}
      .miniRow{
        border:1px solid var(--line);
        border-radius: 14px;
        padding:10px;
        background: rgba(255,255,255,.04);
        cursor:pointer;
      }
      @media (prefers-color-scheme: light){ .miniRow{background: rgba(255,255,255,.75);} }
      .miniRow b{display:block; font-size:13px; margin-bottom:4px}
      .miniRow .mmeta{font-size:11px; color:var(--muted); display:flex; flex-wrap:wrap; gap:8px}
    `;
    const st = document.createElement("style");
    st.textContent = css;
    document.head.appendChild(st);
  })();

  // ---------- ensure Month tab buttons exist ----------
  function ensureMonthTabButtons(){
    const topTabs = $("tabsTop");
    const bottomTabs = $("tabsBottom");
    if(!topTabs || !bottomTabs) return;

    // If already exists, skip
    if($$(`.tab[data-tab="month"]`, document).length) return;

    const mkBtn = (label, titleText)=>{
      const b = document.createElement("button");
      b.className = "tab";
      b.setAttribute("data-tab","month");
      b.setAttribute("role","tab");
      b.title = titleText || "M√™s";
      b.textContent = label;
      return b;
    };

    // Insert after Semana
    const insertAfter = (container)=>{
      const weekBtn = container.querySelector(`.tab[data-tab="week"]`);
      const btn = (container.id==="tabsBottom") ? mkBtn("üóìÔ∏è","M√™s") : mkBtn("üóìÔ∏è M√™s","M√™s");
      if(weekBtn && weekBtn.nextSibling) container.insertBefore(btn, weekBtn.nextSibling);
      else container.appendChild(btn);
    };

    insertAfter(topTabs);
    insertAfter(bottomTabs);

    // Bind click
    $$(`.tab[data-tab="month"]`).forEach(btn=>{
      btn.addEventListener("click", ()=>window.setTab("month"));
    });
  }

  // ---------- create viewMonth container ----------
  function ensureMonthView(){
    if($("viewMonth")) return;

    // We'll append as sibling of existing views inside the LEFT card .bd
    const bd = document.querySelector('section.card[aria-label="Conte√∫do"] .bd');
    if(!bd) return;

    const wrap = document.createElement("div");
    wrap.id = "viewMonth";
    wrap.style.display = "none";
    wrap.innerHTML = `
      <div class="monthWrap">
        <div class="monthTop">
          <div class="monthTitle">
            <b id="monthLabel">‚Äî</b>
            <span id="monthSub">Calend√°rio mensal (clique no dia para ver detalhes)</span>
          </div>
          <div class="monthBtns">
            <button class="btn" id="btnMonthPrev" title="M√™s anterior">‚Üê</button>
            <button class="btn" id="btnMonthToday" title="Voltar para hoje">Hoje</button>
            <button class="btn" id="btnMonthNext" title="Pr√≥ximo m√™s">‚Üí</button>
            <button class="btn primary" id="btnMonthQuickNew" title="Criar no dia selecionado">Ôºã Criar</button>
          </div>
        </div>

        <div class="monthGrid" aria-label="Calend√°rio mensal">
          <div class="monthHead" id="monthHead"></div>
          <div class="monthBody" id="monthBody"></div>
        </div>

        <div class="drawer" aria-label="Detalhes do dia">
          <div class="drawerTop">
            <div>
              <b id="drawerTitle">Selecione um dia</b><br/>
              <span id="drawerSub">Mostra compromissos, tarefas e notas desse dia.</span>
            </div>
            <div class="monthBtns">
              <button class="btn" id="btnDayNewEvent">üìÖ Compromisso</button>
              <button class="btn" id="btnDayNewTask">‚úÖ Tarefa</button>
              <button class="btn" id="btnDayNewNote">üìù Nota</button>
            </div>
          </div>
          <div class="drawerList" id="drawerList"></div>
        </div>

        <div class="hint">
          Dica: arraste uma <b>tarefa</b> do Kanban e solte em um dia do m√™s para mudar o vencimento.
        </div>
      </div>
    `;

    // Insert between Week and Tasks if possible
    const viewWeek = $("viewWeek");
    if(viewWeek && viewWeek.nextSibling) bd.insertBefore(wrap, viewWeek.nextSibling);
    else bd.appendChild(wrap);

    // Head labels
    const head = $("monthHead");
    head.innerHTML = Array.from({length:7}, (_,i)=>`<div class="mhCell">${fmtWeekdayShort(i)}</div>`).join("");
  }

  // ---------- month state ----------
  S.month = S.month || {
    cursor: parseMonthKey(localStorage.getItem(LS_MONTH_CURSOR)) || new Date(new Date().getFullYear(), new Date().getMonth(), 1),
    selected: startOfDay(new Date())
  };

  function persistMonth(){
    localStorage.setItem(LS_MONTH_CURSOR, monthKey(S.month.cursor));
  }

  // ---------- patch setTab to include month + persistence ----------
  const _setTab = window.setTab;
  window.setTab = function(tab){
    // persist
    try{ localStorage.setItem(LS_ACTIVE_TAB, tab); }catch(e){}

    // toggle viewMonth if present
    if($("viewMonth")){
      $("viewMonth").style.display = (tab==="month") ? "block" : "none";
    }

    // update titles for month
    if(tab==="month"){
      S.activeTab = "month";
      // make other views hidden (reuse original to keep UI consistent):
      // call original setTab to manage buttons/labels for known tabs,
      // but it doesn't know "month". We'll fake by setting week then swap.
      try{ _setTab("week"); }catch(e){}
      // fix active classes
      TAB_ORDER.forEach(t=>{
        $$(`.tab[data-tab="${t}"]`).forEach(btn=>btn.classList.toggle("active", t===tab));
      });

      // hide all views except month
      ["today","week","tasks","notes","files","settings"].forEach(id=>{
        const v = document.getElementById("view"+id.charAt(0).toUpperCase()+id.slice(1));
        if(v) v.style.display = "none";
      });
      if($("viewMonth")) $("viewMonth").style.display = "block";

      // page title/sub
      if($("pageTitle")) $("pageTitle").textContent = "M√™s";
      if($("pageSub")) $("pageSub").textContent = "Calend√°rio mensal (vis√£o geral + detalhes do dia)";
      if($("rightSub")) $("rightSub").textContent = "Calend√°rio mensal (vis√£o geral + detalhes do dia)";

      // render month
      rafMonth();
      return;
    }

    // normal path
    return _setTab(tab);
  };

  // ---------- render month ----------
  let monthQueued = false;
  function rafMonth(){
    if(monthQueued) return;
    monthQueued = true;
    requestAnimationFrame(()=>{
      monthQueued = false;
      renderMonth();
    });
  }

  function itemsForDay(day){
    const d0 = startOfDay(day);
    const d1 = addDays(d0, 1);
    return S.items.filter(it=>{
      const key = it.start || it.due || it.createdAt;
      const dt = new Date(key);
      if(isNaN(dt.getTime())) return false;

      // event overlaps day
      if(it.type==="event"){
        const a = it.start ? new Date(it.start) : dt;
        const b = it.end ? new Date(it.end) : a;
        return (a < d1 && b >= d0);
      }

      // task due (or start)
      if(it.type==="task"){
        const a = it.due ? new Date(it.due) : (it.start ? new Date(it.start) : dt);
        return (a >= d0 && a < d1);
      }

      // note created
      return (dt >= d0 && dt < d1);
    });
  }

  function renderDrawer(){
    const title = $("drawerTitle");
    const sub = $("drawerSub");
    const list = $("drawerList");
    if(!title || !list) return;

    const day = startOfDay(S.month.selected || new Date());
    const nice = day.toLocaleDateString("pt-BR",{weekday:"long", day:"2-digit", month:"long", year:"numeric"});
    title.textContent = nice;
    sub.textContent = "Clique em um item para editar.";

    const items = itemsForDay(day).sort((a,b)=> new Date(a.start||a.due||a.createdAt) - new Date(b.start||b.due||b.createdAt));

    if(!items.length){
      list.innerHTML = `<div class="hint">Sem registros nesse dia. Use os bot√µes acima para criar.</div>`;
      return;
    }

    const typeEmoji = (t)=> t==="event"?"üìÖ":t==="task"?"‚úÖ":"üìù";
    const fmtNiceDT = (x)=>{
      const d = new Date(x);
      if(isNaN(d.getTime())) return "‚Äî";
      return d.toLocaleString("pt-BR",{day:"2-digit", month:"2-digit", hour:"2-digit", minute:"2-digit"});
    };

    list.innerHTML = items.map(it=>{
      const when = it.type==="event"
        ? (it.start ? `In√≠cio: ${fmtNiceDT(it.start)}` : "Sem hor√°rio")
        : it.type==="task"
          ? (it.due ? `Vence: ${fmtNiceDT(it.due)}` : "Sem vencimento")
          : `Criado: ${fmtNiceDT(it.createdAt)}`;
      const tags = (it.tags||[]).slice(0,3).map(t=>`<span class="badge">#${escapeHtml(t)}</span>`).join(" ");
      const files = (it.files||[]).length ? `<span class="badge">üìé ${it.files.length}</span>` : "";
      return `
        <div class="miniRow" tabindex="0" data-open="${it.id}">
          <b>${typeEmoji(it.type)} ${escapeHtml(it.title||"(sem t√≠tulo)")}</b>
          <div class="mmeta">
            <span class="badge">${escapeHtml(when)}</span>
            ${it.locationName ? `<span class="badge">üìç ${escapeHtml(it.locationName)}</span>` : ""}
            ${files}
            ${tags}
          </div>
        </div>
      `;
    }).join("");

    $$("[data-open]", list).forEach(el=>{
      const id = el.getAttribute("data-open");
      el.addEventListener("click", ()=>window.openEditModal(id));
      el.addEventListener("keydown",(e)=>{
        if(e.key==="Enter" || e.key===" "){ e.preventDefault(); window.openEditModal(id); }
      });
    });
  }

  function renderMonth(){
    ensureMonthTabButtons();
    ensureMonthView();

    const body = $("monthBody");
    const label = $("monthLabel");
    if(!body || !label) return;

    const cur = new Date(S.month.cursor.getFullYear(), S.month.cursor.getMonth(), 1);
    const monthName = cur.toLocaleDateString("pt-BR",{month:"long", year:"numeric"});
    label.textContent = monthName.charAt(0).toUpperCase() + monthName.slice(1);

    // month range in grid: start Monday before 1st, end Sunday after last
    const first = new Date(cur.getFullYear(), cur.getMonth(), 1);
    const last  = new Date(cur.getFullYear(), cur.getMonth()+1, 0);
    const gridStart = startOfWeekMon(first);
    const gridEnd = addDays(startOfWeekMon(addDays(last, 7)), 6); // ensures cover last week
    const totalDays = Math.round((startOfDay(gridEnd) - startOfDay(gridStart)) / (24*3600*1000)) + 1;

    const today = startOfDay(new Date());
    body.innerHTML = "";

    for(let i=0;i<totalDays;i++){
      const day = addDays(gridStart, i);
      const inMonth = day.getMonth()===cur.getMonth();
      const isToday = +startOfDay(day)===+today;
      const sel = +startOfDay(day)===+startOfDay(S.month.selected||today);

      const items = itemsForDay(day);
      const cEvent = items.filter(x=>x.type==="event").length;
      const cTask  = items.filter(x=>x.type==="task" && x.status!=="done" && x.status!=="canceled").length;
      const cNote  = items.filter(x=>x.type==="note").length;

      const cell = document.createElement("div");
      cell.className = `dayCell ${inMonth?"":"out"} ${isToday?"today":""}`;
      cell.setAttribute("tabindex","0");
      cell.dataset.date = toISODate(day);
      cell.innerHTML = `
        <div class="dayNum">
          <span>${day.getDate()}</span>
          <small>${sel ? "‚Ä¢" : ""}</small>
        </div>
        <div class="dayBadges">
          ${cEvent?`<span class="dotBadge">üìÖ ${cEvent}</span>`:""}
          ${cTask?`<span class="dotBadge">‚úÖ ${cTask}</span>`:""}
          ${cNote?`<span class="dotBadge">üìù ${cNote}</span>`:""}
        </div>
      `;

      // click select day
      cell.addEventListener("click", ()=>{
        S.month.selected = startOfDay(day);
        renderMonth(); // re-render to update selection dot
        renderDrawer();
      });
      cell.addEventListener("keydown",(e)=>{
        if(e.key==="Enter" || e.key===" "){
          e.preventDefault();
          S.month.selected = startOfDay(day);
          renderMonth();
          renderDrawer();
        }
      });

      // drag/drop tasks -> set due date
      cell.addEventListener("dragover",(e)=>{ e.preventDefault(); cell.classList.add("drop"); });
      cell.addEventListener("dragleave",()=> cell.classList.remove("drop"));
      cell.addEventListener("drop",(e)=>{
        e.preventDefault();
        cell.classList.remove("drop");
        const id = e.dataTransfer.getData("text/plain");
        const it = S.items.find(x=>x.id===id);
        if(!it || it.type!=="task") return window.toast("S√≥ tarefas podem ser soltas no m√™s.");
        const d = startOfDay(day);
        // keep time if existed, else set 18:00 default local
        let due = it.due ? new Date(it.due) : new Date();
        due = new Date(d.getFullYear(), d.getMonth(), d.getDate(), due.getHours()||18, due.getMinutes()||0);
        it.due = due.toISOString();
        it.status = (it.kanban==="done") ? "done" : (it.kanban==="doing" ? "doing" : it.status);
        it.updatedAt = Date.now();
        window.saveAll();
        window.toast("Vencimento atualizado.");
        window.rafRender();
        rafMonth();
        renderDrawer();
      });

      body.appendChild(cell);
    }

    renderDrawer();
    bindMonthButtonsOnce();
  }

  // ---------- month buttons bindings (once) ----------
  let monthBound = false;
  function bindMonthButtonsOnce(){
    if(monthBound) return;
    monthBound = true;

    $("btnMonthPrev")?.addEventListener("click", ()=>{
      S.month.cursor = new Date(S.month.cursor.getFullYear(), S.month.cursor.getMonth()-1, 1);
      persistMonth();
      rafMonth();
    });
    $("btnMonthNext")?.addEventListener("click", ()=>{
      S.month.cursor = new Date(S.month.cursor.getFullYear(), S.month.cursor.getMonth()+1, 1);
      persistMonth();
      rafMonth();
    });
    $("btnMonthToday")?.addEventListener("click", ()=>{
      const t = new Date();
      S.month.cursor = new Date(t.getFullYear(), t.getMonth(), 1);
      S.month.selected = startOfDay(t);
      persistMonth();
      rafMonth();
    });
    $("btnMonthQuickNew")?.addEventListener("click", ()=>{
      // quick open modal and prefill date
      const d = startOfDay(S.month.selected || new Date());
      window.openNewModal("event");
      // best effort prefill fields if exist
      const mStart = $("mStart");
      if(mStart){
        const dt = new Date(d.getFullYear(), d.getMonth(), d.getDate(), 9, 0);
        mStart.value = `${toISODate(dt)}T09:00`;
      }
      const mEnd = $("mEnd");
      if(mEnd){
        const dt2 = new Date(d.getFullYear(), d.getMonth(), d.getDate(), 10, 0);
        mEnd.value = `${toISODate(dt2)}T10:00`;
      }
    });

    // Create at selected day
    $("btnDayNewEvent")?.addEventListener("click", ()=>createOnSelected("event"));
    $("btnDayNewTask")?.addEventListener("click", ()=>createOnSelected("task"));
    $("btnDayNewNote")?.addEventListener("click", ()=>createOnSelected("note"));
  }

  function createOnSelected(type){
    const d = startOfDay(S.month.selected || new Date());
    window.openNewModal(type);

    // Prefill based on type
    if(type==="event"){
      $("mStart").value = `${toISODate(d)}T09:00`;
      $("mEnd").value = `${toISODate(d)}T10:00`;
    }else if(type==="task"){
      $("mDue").value = `${toISODate(d)}T18:00`;
      $("mKanban").value = "todo";
    }else{
      // note: nothing required
    }

    // title hint
    $("mTitle").value = $("mTitle").value || `(${type==="event"?"Compromisso":type==="task"?"Tarefa":"Nota"}) ${toISODate(d)}`;
    $("mBody").value = $("mBody").value || "";
    window.toast("Preenchido com a data do dia selecionado.");
  }

  // ---------- persist active tab on load ----------
  function restoreActiveTab(){
    const t = localStorage.getItem(LS_ACTIVE_TAB);
    if(t && TAB_ORDER.includes(t)){
      window.setTab(t);
      return;
    }
  }

  // ---------- keyboard shortcuts for month ----------
  document.addEventListener("keydown",(e)=>{
    if(e.altKey && e.key.toLowerCase()==="m"){
      e.preventDefault();
      window.setTab("month");
    }
    // month nav (when on month)
    if(S.activeTab==="month"){
      if(e.key==="ArrowLeft"){
        S.month.selected = addDays(startOfDay(S.month.selected||new Date()), -1);
        // auto change month if needed
        if(S.month.selected.getMonth()!==S.month.cursor.getMonth() || S.month.selected.getFullYear()!==S.month.cursor.getFullYear()){
          S.month.cursor = new Date(S.month.selected.getFullYear(), S.month.selected.getMonth(), 1);
          persistMonth();
        }
        rafMonth(); renderDrawer();
      }
      if(e.key==="ArrowRight"){
        S.month.selected = addDays(startOfDay(S.month.selected||new Date()), +1);
        if(S.month.selected.getMonth()!==S.month.cursor.getMonth() || S.month.selected.getFullYear()!==S.month.cursor.getFullYear()){
          S.month.cursor = new Date(S.month.selected.getFullYear(), S.month.selected.getMonth(), 1);
          persistMonth();
        }
        rafMonth(); renderDrawer();
      }
    }
  });

  // ---------- hook into existing renderAll ----------
  // Whenever your app renders, if month active, ensure month is also up-to-date
  const _renderAll = window.renderAll;
  if(typeof _renderAll === "function"){
    window.renderAll = async function(){
      const r = await _renderAll();
      if(S.activeTab==="month"){
        rafMonth();
      }
      return r;
    };
  }

  // ---------- boot month feature ----------
  ensureMonthTabButtons();
  ensureMonthView();
  // restore tab after initial init
  setTimeout(()=>{ restoreActiveTab(); }, 0);
  // if already on month, render
  if(S.activeTab==="month") rafMonth();

})();
</script>

<!-- =========================================================
     FECHAMENTO FINAL (se a PARTE 1 j√° fechou o arquivo, ignore isto.
     Se voc√™ removeu o fechamento para colar a PARTE 2, ent√£o mantenha.)
========================================================== -->
</body>
</html>

