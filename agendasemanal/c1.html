<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App com Políticas de Usuário</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap">
    <style>
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: #f4f7fb; 
            color: #333; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0;
        }
        .container {
            width: 90%;
            max-width: 400px;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        h2 { color: #2c3e50; font-size: 1.8em; margin-bottom: 15px; }
        input[type="text"], input[type="password"] {
            width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; font-size: 16px;
        }
        button { 
            width: 100%; padding: 12px; margin-top: 10px; border: none; border-radius: 5px; font-size: 16px;
            background-color: #007bff; color: #fff; cursor: pointer; transition: background-color 0.3s;
        }
        button:hover { background-color: #0056b3; }
        .link { color: #007bff; cursor: pointer; text-decoration: none; font-size: 14px; margin-top: 10px; display: inline-block; }
        .policy-text { font-size: 14px; text-align: justify; color: #666; margin-bottom: 15px; }
    </style>
</head>
<body>

    <!-- Tela de Login -->
    <div id="login-container" class="container">
        <h2>Login</h2>
        <input type="text" id="username" placeholder="Nome de Usuário" autocomplete="username">
        <input type="password" id="password" placeholder="Senha" autocomplete="current-password">
        <button onclick="login()">Entrar</button>
        <p>Não tem uma conta? <a class="link" onclick="showRegister()">Registrar-se</a></p>
    </div>

    <!-- Tela de Registro -->
    <div id="register-container" class="container" style="display:none;">
        <h2>Registrar-se</h2>
        <input type="text" id="register-username" placeholder="Nome de Usuário" autocomplete="username">
        <input type="password" id="register-password" placeholder="Senha (4 dígitos)" autocomplete="new-password">
        <div class="policy-text">
            <p>Bem-vindo ao nosso aplicativo. Ao utilizar nossos serviços, você concorda com os seguintes termos:</p>
            <ul>
                <li><strong>Uso Responsável:</strong> Utilize o app de forma responsável.</li>
                <li><strong>Privacidade:</strong> Seus dados são tratados conforme nossa política de privacidade.</li>
                <li><strong>Limitação de Responsabilidade:</strong> Não nos responsabilizamos por qualquer dano decorrente do uso.</li>
                <li><strong>Alterações de Serviço:</strong> Reservamo-nos o direito de modificar o app.</li>
            </ul>
            <p>Para continuar, você deve aceitar as políticas de usuário.</p>
        </div>
        <label>
            <input type="checkbox" id="accept-policy"> Eu aceito as políticas de usuário.
        </label>
        <button onclick="register()">Registrar</button>
        <p>Já tem uma conta? <a class="link" onclick="showLogin()">Voltar ao Login</a></p>
    </div>

    <!-- Tela Principal do App -->
    <div id="app-container" class="container" style="display:none;">
        <h2>Bem-vindo!</h2>
        <button onclick="logout()">Logout</button>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>

    <script>
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAIp-rFuZZsBCNVJ3pSge4TE-XUuwYygrI",
            authDomain: "agenda-6accc.firebaseapp.com",
            databaseURL: "https://agenda-6accc-default-rtdb.firebaseio.com",
            projectId: "agenda-6accc",
            storageBucket: "agenda-6accc.appspot.com",
            messagingSenderId: "205960633520",
            appId: "1:205960633520:web:c9b1b9e166a8e3daed1dc6"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        function showLogin() {
            document.getElementById('login-container').style.display = 'block';
            document.getElementById('register-container').style.display = 'none';
            document.getElementById('app-container').style.display = 'none';
        }

        function showRegister() {
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('register-container').style.display = 'block';
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            db.collection("users").doc(username).get().then(doc => {
                if (doc.exists && doc.data().password === password) {
                    showApp();
                } else {
                    alert("Nome de usuário ou senha incorretos.");
                }
            });
        }

        function showApp() {
            document.getElementById('app-container').style.display = 'block';
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('register-container').style.display = 'none';
        }

        function logout() {
            showLogin();
        }

        function register() {
            const username = document.getElementById('register-username').value;
            const password = document.getElementById('register-password').value;
            const accepted = document.getElementById('accept-policy').checked;

            if (password.length !== 4) {
                alert("Senha deve ter exatamente 4 dígitos.");
                return;
            }

            if (!accepted) {
                alert("Você deve aceitar as políticas para continuar.");
                return;
            }

            db.collection("users").doc(username).get().then(doc => {
                if (doc.exists) {
                    alert("Usuário já existe. Escolha outro nome de usuário.");
                } else {
                    db.collection("users").doc(username).set({ password: password })
                        .then(() => {
                            alert("Usuário registrado com sucesso!");
                            showLogin();
                        });
                }
            });
        }
    </script>
</body>
</html>


